import streamlit as st
import numpy as np
import matplotlib.pyplot as plt

# Configuraci贸n general
st.set_page_config(page_title="Planificaci贸n Financiera", layout="wide")

# T铆tulo principal
st.title(" Planificaci贸n Financiera Personal")
st.subheader("Gestiona tus metas: Casa en 10 a帽os y Retiro a largo plazo")

# Crear pesta帽as
tab1, tab2, tab3 = st.tabs([" Comprar Casa", " Planificaci贸n para el Retiro", "锔 Personalizaci贸n de Gastos"])

# Pesta帽a: Comprar Casa
with tab1:
    st.header("Planificaci贸n para Comprar Casa")
    # Entradas del usuario
    casa_costo = st.number_input("Costo estimado de la casa:", min_value=100000.0, value=1500000.0, step=10000.0)
    ahorros_actuales = st.number_input("Ahorros actuales:", min_value=0.0, value=100000.0, step=10000.0)
    plazo_a帽os = st.slider("Plazo para la compra (a帽os):", min_value=5, max_value=20, value=10)
    inflacion = st.slider("Inflaci贸n anual esperada (%):", min_value=0.0, max_value=10.0, value=3.0, step=0.1)
    rendimiento = st.slider("Rendimiento anual de inversi贸n (%):", min_value=0.0, max_value=15.0, value=6.0, step=0.1)
    
    # C谩lculos
    inflacion_factor = (1 + inflacion / 100) ** plazo_a帽os
    costo_futuro = casa_costo * inflacion_factor
    ahorro_necesario = (costo_futuro - ahorros_actuales) / (plazo_a帽os * 12)

    # Resultados
    st.write(f"**Costo futuro de la casa**: ${costo_futuro:,.2f}")
    st.write(f"**Ahorro mensual necesario**: ${ahorro_necesario:,.2f}")

    # Gr谩fica de proyecci贸n
    meses = np.arange(1, plazo_a帽os * 12 + 1)
    ahorro_proyectado = ahorros_actuales + ahorro_necesario * meses
    plt.figure(figsize=(10, 5))
    plt.plot(meses, ahorro_proyectado, label="Ahorros Proyectados", color='purple')
    plt.axhline(y=costo_futuro, color='red', linestyle='--', label="Meta (Costo Futuro)")
    plt.xlabel("Meses")
    plt.ylabel("Ahorros")
    plt.title("Proyecci贸n de Ahorros para Comprar Casa")
    plt.legend()
    st.pyplot(plt)

# Pesta帽a: Planificaci贸n para el Retiro
with tab2:
    st.header("Planificaci贸n para el Retiro")
    # Entradas del usuario
    edad_actual = st.number_input("Tu edad actual:", min_value=18, max_value=100, value=22)
    edad_retiro = st.number_input("Edad deseada de retiro:", min_value=40, max_value=100, value=65)
    gastos_mensuales = st.number_input("Gastos mensuales estimados en retiro:", min_value=0.0, value=20000.0, step=1000.0)
    ahorro_actual = st.number_input("Ahorro actual para el retiro:", min_value=0.0, value=50000.0, step=5000.0)
    rendimiento_retiro = st.slider("Rendimiento anual de inversi贸n (%):", min_value=0.0, max_value=15.0, value=5.0, step=0.1)
    inflacion_retiro = st.slider("Inflaci贸n anual esperada (%):", min_value=0.0, max_value=10.0, value=3.0, step=0.1)

    # C谩lculos
    a帽os_retiro = edad_retiro - edad_actual
    gastos_futuros = gastos_mensuales * (1 + inflacion_retiro / 100) ** a帽os_retiro
    capital_necesario = gastos_futuros * 12 * (edad_retiro - 85)  # Supone 20 a帽os de retiro
    ahorro_mensual_retiro = (capital_necesario - ahorro_actual) / (a帽os_retiro * 12)

    # Resultados
    st.write(f"**Gastos mensuales ajustados por inflaci贸n**: ${gastos_futuros:,.2f}")
    st.write(f"**Capital necesario para el retiro**: ${capital_necesario:,.2f}")
    st.write(f"**Ahorro mensual necesario**: ${ahorro_mensual_retiro:,.2f}")

    # Gr谩fica de proyecci贸n
    meses_retiro = np.arange(1, a帽os_retiro * 12 + 1)
    ahorro_proyectado_retiro = ahorro_actual + ahorro_mensual_retiro * meses_retiro
    plt.figure(figsize=(10, 5))
    plt.plot(meses_retiro, ahorro_proyectado_retiro, label="Ahorros Proyectados para Retiro", color='blue')
    plt.axhline(y=capital_necesario, color='red', linestyle='--', label="Meta (Capital Necesario)")
    plt.xlabel("Meses")
    plt.ylabel("Ahorros")
    plt.title("Proyecci贸n de Ahorros para el Retiro")
    plt.legend()
    st.pyplot(plt)

# Pesta帽a: Personalizaci贸n de Gastos
with tab3:
    st.header("Personalizaci贸n de Gastos")
    st.write("**(Pr贸ximamente)** Personaliza tus gastos anuales y observa c贸mo afectan tus metas.")
